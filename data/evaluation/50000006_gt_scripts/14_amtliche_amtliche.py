# Q: Um wie viele Kilometer wurde das Rohrleitungsnetz der Stadt Zürich zwischen Ende 2008 und Ende 2024 kürzer? Runde auf zwei Nachkommastellen.
# Relevant datasets: ['Amtliche Vermessungsdaten Stadt Zürich Jahresendstand 2008', 'Amtliche Vermessungsdaten Stadt Zürich Jahresendstand 2024']

import geopandas as gpd


# Layers in dataset Amtliche Vermessungsdaten Stadt Zürich Jahresendstand 2008: ['geoz_2008.av_geb_lokalisationsname', 'geoz_2008.av_ei_eonachfuehrung', 'geoz_2008.av_bo_bbnachfuehrung', 'geoz_2008.av_li_lsnachfuehrung', 'geoz_2008.av_li_grundstueck_t', 'geoz_2008.av_ro_linienelement', 'geoz_2008.av_bo_boflaeche_l', 'geoz_2008.av_li_grenzpunkt', 'geoz_2008.av_fi_hfp1_t', 'geoz_2008.av_fi_lfp3', 'geoz_2008.av_geb_strassennamen_uep5_t', 'geoz_2008.av_geb_gebaeudeadresse_t', 'geoz_2008.av_fi_lfp3_t', 'geoz_2008.av_li_selbstrecht_a', 'geoz_2008.av_geb_strassennamen_t', 'geoz_2008.av_fi_hfp2', 'geoz_2008.av_ei_flaechenelement_a', 'geoz_2008.av_bo_boflaechesymbol', 'geoz_2008.av_fi_hfp2_t', 'geoz_2008.av_ei_linienelement', 'geoz_2008.av_bo_gebaeudenummer_t', 'geoz_2008.av_li_projgrundstueck_t', 'geoz_2008.av_bo_objektname_t', 'geoz_2008.av_fi_hfp1', 'geoz_2008.av_ei_objektname_t', 'geoz_2008.av_li_grenzpunkt_t', 'geoz_2008.av_be_bezirksgrenzabschnitt', 'geoz_2008.av_li_projliegenschaft_a', 'geoz_2008.av_bo_projgebaeudenummer_t', 'geoz_2008.av_fi_lfp2', 'geoz_2008.av_fi_lfp2_t', 'geoz_2008.av_fi_hfp3_t', 'geoz_2008.av_fi_hfp3', 'geoz_2008.av_li_liegenschaft_a', 'geoz_2008.av_fi_lfp1_t', 'geoz_2008.av_fi_lfp1', 'geoz_2008.av_ei_objektnummer_t', 'geoz_2008.av_bo_projboflaeche_a', 'geoz_2008.av_geb_strassenstueck', 'geoz_2008.av_bo_boflaeche_a', 'geoz_2008.av_ei_flaechenelement_a_r_v', 'geoz_2008.av_li_projselbstrecht_a', 'geoz_2008.av_no_flurname_t', 'geoz_2008.av_plz_einteilung_a', 'geoz_2008.av_ge_gemeindegrenze_boundary', 'geoz_2008.av_ge_gemeindegrenze_a', 'geoz_2008.av_geb_gebaeudeadresse_uep5_t', 'geoz_2008.av_geb_strassenstueck_ap', 'geoz_2008.av_ei_flaechenelement_a_p_v']
# Layers in dataset Amtliche Vermessungsdaten Stadt Zürich Jahresendstand 2024: ['geoz_2024.av_li_lsnachfuehrung', 'geoz_2024.av_geb_lokalisationsname', 'geoz_2024.av_bo_bbnachfuehrung', 'geoz_2024.av_ei_eonachfuehrung', 'geoz_2024.av_bo_boflaechesymbol', 'geoz_2024.av_geb_strassennamen_t', 'geoz_2024.av_li_projgrundstueck_t', 'geoz_2024.av_li_selbstrecht_a', 'geoz_2024.av_ei_objektname_uep5_t', 'geoz_2024.av_li_liegenschaft_a', 'geoz_2024.av_geb_strassenstueck', 'geoz_2024.av_li_grenzpunkt_t', 'geoz_2024.av_fi_lfp1', 'geoz_2024.av_fi_lfp2_t', 'geoz_2024.av_ei_linienelement', 'geoz_2024.av_be_bezirksgrenzabschnitt', 'geoz_2024.av_ge_hoheitsgrenzpunkt_t', 'geoz_2024.av_bo_projgebaeudenummer_t', 'geoz_2024.av_fi_lfp3', 'geoz_2024.av_fi_lfp3_t', 'geoz_2024.av_bo_boflaeche_l', 'geoz_2024.av_ei_allegebaeude_a_v', 'geoz_2024.av_li_grenzpunkt', 'geoz_2024.av_ei_flaechenelement_a', 'geoz_2024.av_ei_objektname_t', 'geoz_2024.av_fi_hfp2_t', 'geoz_2024.av_geb_gebaeudeadresse_uep5_t', 'geoz_2024.av_geb_strassenstueck_ap', 'geoz_2024.av_bo_gebaeudenummer_t', 'geoz_2024.av_ei_objektnummer_t', 'geoz_2024.av_ge_gemeindegrenze_a', 'geoz_2024.av_ro_linienelement', 'geoz_2024.av_bo_objektname_t', 'geoz_2024.av_li_projliegenschaft_a', 'geoz_2024.av_geb_strassennamen_uep5_t', 'geoz_2024.av_no_flurname_t', 'geoz_2024.av_fi_hfp3_t', 'geoz_2024.av_fi_hfp2', 'geoz_2024.av_fi_hfp3', 'geoz_2024.av_plz_einteilung_a', 'geoz_2024.av_bo_projboflaeche_a', 'geoz_2024.av_geb_kurzstrnamen_uep5_t', 'geoz_2024.av_fi_lfp2', 'geoz_2024.av_no_flurname_uep5_t', 'geoz_2024.av_fi_hfp1', 'geoz_2024.av_fi_hfp1_t', 'geoz_2024.av_li_grundstueck_t', 'geoz_2024.av_ge_gemeindegrenze_boundary', 'geoz_2024.av_ge_hoheitsgrenzpunkt', 'geoz_2024.av_fi_lfp1_t', 'geoz_2024.av_bo_allegebaeude_a_v', 'geoz_2024.av_bo_objektname_uep5_t', 'geoz_2024.av_geb_gebaeudeadresse_t', 'geoz_2024.av_bo_boflaeche_a']

### Solution ###
# Challenge: documentation mediocre, many layers
gdf_amtli_2008 = gpd.read_file("./data/opendata/50000006/extracted/amtliche_vermessungsdaten_stadt_zuerich_jahresendstand_2008.gpkg", layer="geoz_2008.av_ro_linienelement")
gdf_amtli_2024 = gpd.read_file("./data/opendata/50000006/extracted/amtliche_vermessungsdaten_stadt_zuerich_jahresendstand_2024.gpkg", layer="geoz_2024.av_ro_linienelement")

# Status Bewilligung is ignored as it is always the same, namely 'bewilligt'
total_length_2008 = gdf_amtli_2008['geometry'].length.sum()
total_length_2024 = gdf_amtli_2024['geometry'].length.sum()
print(round((total_length_2008 - total_length_2024)/1E3, 2))